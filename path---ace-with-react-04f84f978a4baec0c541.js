webpackJsonp([26418689689010],{854:function(e,t){e.exports={data:{post:{id:"/Users/prasanna/projects/blog/content/posts/2020-08-01--ace-with-react/index.md absPath of file >>> MarkdownRemark",html:'<h2>Atlassian Connect Express (ACE)</h2>\n<p>ACE is a toolkit in node.js to build atlassian connect apps. Like a JIRA, Confluence plugins. </p>\n<p>Best way to start with ACE is to bootstrap from <code class="language-text">atlas-connect</code> Y<a href="https://bitbucket.org/atlassian/atlassian-connect-express/src/master/">ou can follow the documentation here to get a sample app up and running in few minutes.</a></p>\n<h2>ACE and handlebars</h2>\n<p>ACE is a wrapper on top of the <a href="https://expressjs.com/">expressjs</a> and hence the application is pretty much an express application. The bootstrapped application will have both the frontend and the backend part.  For the frontend, ACE by default uses <a href="https://handlebarsjs.com/">handlebars</a> as templating option.</p>\n<p>When you make a API call, the server converts the handlebar templates into HTML and returns.</p>\n<h2>Replace Handlebars views with a SPA</h2>\n<p>As you can see, the above mechanism isn’t tailored to use any single page application. Luckily, ACE doesn’t change lots of things from express and hence we can use the same technique to achieve the goal.</p>\n<p><strong><em>In this example I’m choosing <a href="https://reactjs.org/">React</a>, however the technique is fairly the same for any SPA framework.</em></strong> Since the idea is fairly simple. Using the framework build the app and deliver it to the browser on the init api call. From then on, the app will be controlled by the browser.</p>\n<h2>Up and running with React.</h2>\n<p><strong>1. Add a route to serve static files.</strong></p>\n<p>To the already bootstrapped ACE project, i added a folder called client, and inside that I used <a href="https://github.com/facebook/create-react-app">CRA</a> to bootstrap my React project. This will be my SPA. Make sure to keep  the built artifact within this folder. In my case it was <code class="language-text">{ProjectRoot}/client/build/*</code></p>\n<p>Now in the express application’s index.js need to modify the route to serve this page. In my case, i used <a href="https://developer.atlassian.com/cloud/jira/software/modules/page/">generalPages module</a> of ACE. In <code class="language-text">atlassian-connect.json</code> I have mentioned <code class="language-text">url</code> to be <code class="language-text">/init</code></p>\n<p>Here is the modified <code class="language-text">/init</code> to serve the react app.</p>\n<div class="gatsby-highlight" data-language="jsx">\n      <pre class="language-jsx"><code class="language-jsx">app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/init\'</span><span class="token punctuation">,</span> addon<span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'/../client/build/\'</span><span class="token punctuation">,</span> <span class="token string">\'index.html\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>you can import the path like this <code class="language-text">import path from &#39;path&#39;;</code> </p>\n<p>2<strong>. Configure static directories for express server.</strong></p>\n<p>Next is to set the path variable for the express. You need to define the static directory for the express server to fetch the files from.</p>\n<p>in <code class="language-text">app.js</code> you can configure this.</p>\n<div class="gatsby-highlight" data-language="jsx">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> addon <span class="token operator">=</span> <span class="token function">ace</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">/* more config */</span>\n\n<span class="token keyword">const</span> staticDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'public\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">//*** This line is important **********//</span>\n\napp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">\'client\'</span><span class="token punctuation">,</span> <span class="token string">\'build\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">//*** This line is important **********//</span>\napp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>staticDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p>Now, we have configured express to look into 2 different directories for static files.</p>\n<p><strong>3. Include atlassian JS API as part of the SPA</strong></p>\n<p>Lastly, we need to make a change in the client app. Jira/Confluence when they load their plugin, they expect the plugin to have <code class="language-text">all.js</code> . This is the client side logic of ace. So, we need to include this as part of our React’s <code class="language-text">index.html</code> without this, <strong><em>the loader in Jira will never disappear</em></strong></p>\n<p>In <code class="language-text">client/public/index.html</code> add the script tag just below the body.</p>\n<div class="gatsby-highlight" data-language="jsx">\n      <pre class="language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>\n    <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://connect-cdn.atl-paas.net/all.js<span class="token punctuation">"</span></span>\n    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span>\n    <span class="token attr-name">data-options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sizeToParent:true;resize:false<span class="token punctuation">"</span></span>\n<span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre>\n      </div>\n<p>You can read about more <code class="language-text">data-options</code> <a href="https://developer.atlassian.com/cloud/jira/software/about-the-javascript-api/">here</a>.</p>\n<p>That’s it, you will now see the React application in the connect app. </p>\n<p><strong>*Note:</strong> In development mode, there isn’t any hot reload in this case. If you make any changes to the react app, need to build the app manually. Ofcourse, you can modify the <code class="language-text">package.json</code> to automate this, but <code class="language-text">webpack-dev-server</code> isn’t much helpful.*</p>\n<h2>Authentication within the connect app</h2>\n<p>If you are planning to bundle few APIs along with the react app, then one of the harder thing to crack is authentication. This isn’t documented very clearly anywhere.</p>\n<p>ACE uses a JWT to authenticate api’s and unfortunately the token isn’t accessible for React application since it is running inside a iframe by default. If you are using the default Handlebars, ACE provides  helper methods to access the JWT. </p>\n<h3>Workaround</h3>\n<p>The first call from JIRA/Confluence call will carry the JWT. In the above code snippet <code class="language-text">addon.authenticate()</code> will validate the JWT executes the callback. In this place, we can create a JWT and set it as cookie header. Post that, in all the API calls made from React app, we can validate the JWT against our secret, and it will sort out the issue of authentication.</p>\n<p>Here is a sample code for a Hello world with ACE and React. <a href="https://github.com/prasann/ace-with-react">Github Source.</a></p>',htmlAst:{type:"root",children:[{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"Atlassian Connect Express (ACE)"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"ACE is a toolkit in node.js to build atlassian connect apps. Like a JIRA, Confluence plugins. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Best way to start with ACE is to bootstrap from "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"atlas-connect"}]},{type:"text",value:" Y"},{type:"element",tagName:"a",properties:{href:"https://bitbucket.org/atlassian/atlassian-connect-express/src/master/"},children:[{type:"text",value:"ou can follow the documentation here to get a sample app up and running in few minutes."}]}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"ACE and handlebars"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"ACE is a wrapper on top of the "},{type:"element",tagName:"a",properties:{href:"https://expressjs.com/"},children:[{type:"text",value:"expressjs"}]},{type:"text",value:" and hence the application is pretty much an express application. The bootstrapped application will have both the frontend and the backend part.  For the frontend, ACE by default uses "},{type:"element",tagName:"a",properties:{href:"https://handlebarsjs.com/"},children:[{type:"text",value:"handlebars"}]},{type:"text",value:" as templating option."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"When you make a API call, the server converts the handlebar templates into HTML and returns."}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"Replace Handlebars views with a SPA"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"As you can see, the above mechanism isn’t tailored to use any single page application. Luckily, ACE doesn’t change lots of things from express and hence we can use the same technique to achieve the goal."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"strong",properties:{},children:[{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"In this example I’m choosing "},{type:"element",tagName:"a",properties:{href:"https://reactjs.org/"},children:[{type:"text",value:"React"}]},{type:"text",value:", however the technique is fairly the same for any SPA framework."}]}]},{type:"text",value:" Since the idea is fairly simple. Using the framework build the app and deliver it to the browser on the init api call. From then on, the app will be controlled by the browser."}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"Up and running with React."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"1. Add a route to serve static files."}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"To the already bootstrapped ACE project, i added a folder called client, and inside that I used "},{type:"element",tagName:"a",properties:{href:"https://github.com/facebook/create-react-app"},children:[{type:"text",value:"CRA"}]},{type:"text",value:" to bootstrap my React project. This will be my SPA. Make sure to keep  the built artifact within this folder. In my case it was "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"{ProjectRoot}/client/build/*"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Now in the express application’s index.js need to modify the route to serve this page. In my case, i used "},{type:"element",tagName:"a",properties:{href:"https://developer.atlassian.com/cloud/jira/software/modules/page/"},children:[{type:"text",value:"generalPages module"}]},{type:"text",value:" of ACE. In "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"atlassian-connect.json"}]},{type:"text",value:" I have mentioned "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"url"}]},{type:"text",value:" to be "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"/init"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Here is the modified "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"/init"}]},{type:"text",value:" to serve the react app."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"jsx"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-jsx"]},children:[{type:"element",tagName:"code",properties:{className:["language-jsx"]},children:[{type:"text",value:"app"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"get"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'/init'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" addon"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"authenticate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"req"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" res"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"=>"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n  res"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"sendFile"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"path"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"join"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"__dirname"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'/../client/build/'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'index.html'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"you can import the path like this "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"import path from 'path';"}]},{type:"text",value:" "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"2"},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:". Configure static directories for express server."}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Next is to set the path variable for the express. You need to define the static directory for the express server to fetch the files from."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"in "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"app.js"}]},{type:"text",value:" you can configure this."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"jsx"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-jsx"]},children:[{type:"element",tagName:"code",properties:{className:["language-jsx"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" app "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"express"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" addon "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"ace"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"app"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"/* more config */"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" staticDir "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" path"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"join"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"__dirname"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'public'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"//*** This line is important **********//"}]},{type:"text",value:"\n\napp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"use"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"express"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"static"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"path"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"join"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"__dirname"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'client'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:"'build'"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"//*** This line is important **********//"}]},{type:"text",value:"\napp"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"use"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"express"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"static"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"staticDir"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Now, we have configured express to look into 2 different directories for static files."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"3. Include atlassian JS API as part of the SPA"}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Lastly, we need to make a change in the client app. Jira/Confluence when they load their plugin, they expect the plugin to have "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"all.js"}]},{type:"text",value:" . This is the client side logic of ace. So, we need to include this as part of our React’s "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"index.html"}]},{type:"text",value:" without this, "},{type:"element",tagName:"strong",properties:{},children:[{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"the loader in Jira will never disappear"}]}]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"In "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"client/public/index.html"}]},{type:"text",value:" add the script tag just below the body."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"jsx"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-jsx"]},children:[{type:"element",tagName:"code",properties:{className:["language-jsx"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"<"}]},{type:"text",value:"script"}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"src"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation","attr-equals"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"https://connect-cdn.atl-paas.net/all.js"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"type"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation","attr-equals"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"text/javascript"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"text",value:"\n    "},{type:"element",tagName:"span",properties:{className:["token","attr-name"]},children:[{type:"text",value:"data-options"}]},{type:"element",tagName:"span",properties:{className:["token","attr-value"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation","attr-equals"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]},{type:"text",value:"sizeToParent:true;resize:false"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:'"'}]}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]},{type:"element",tagName:"span",properties:{className:["token","script"]},children:[]},{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","tag"]},children:[{type:"element",tagName:"span",properties:{className:["token","punctuation"]
},children:[{type:"text",value:"</"}]},{type:"text",value:"script"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:">"}]}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"You can read about more "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"data-options"}]},{type:"text",value:" "},{type:"element",tagName:"a",properties:{href:"https://developer.atlassian.com/cloud/jira/software/about-the-javascript-api/"},children:[{type:"text",value:"here"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"That’s it, you will now see the React application in the connect app. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"*Note:"}]},{type:"text",value:" In development mode, there isn’t any hot reload in this case. If you make any changes to the react app, need to build the app manually. Ofcourse, you can modify the "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"package.json"}]},{type:"text",value:" to automate this, but "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"webpack-dev-server"}]},{type:"text",value:" isn’t much helpful.*"}]},{type:"text",value:"\n"},{type:"element",tagName:"h2",properties:{},children:[{type:"text",value:"Authentication within the connect app"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"If you are planning to bundle few APIs along with the react app, then one of the harder thing to crack is authentication. This isn’t documented very clearly anywhere."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"ACE uses a JWT to authenticate api’s and unfortunately the token isn’t accessible for React application since it is running inside a iframe by default. If you are using the default Handlebars, ACE provides  helper methods to access the JWT. "}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"Workaround"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"The first call from JIRA/Confluence call will carry the JWT. In the above code snippet "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"addon.authenticate()"}]},{type:"text",value:" will validate the JWT executes the callback. In this place, we can create a JWT and set it as cookie header. Post that, in all the API calls made from React app, we can validate the JWT against our secret, and it will sort out the issue of authentication."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Here is a sample code for a Hello world with ACE and React. "},{type:"element",tagName:"a",properties:{href:"https://github.com/prasann/ace-with-react"},children:[{type:"text",value:"Github Source."}]}]}],data:{quirksMode:!1}},fields:{slug:"/ace-with-react/",prefix:"2020-08-01"},frontmatter:{title:"ACE with React",subTitle:"Integrating a single page application with atlassian connect express.",draft:!1}},author:{id:"/Users/prasanna/projects/blog/content/parts/author.md absPath of file >>> MarkdownRemark",html:"<p><strong>Prasanna</strong> is a full stack web developer, with exposure to various programming languages.\nUses mostly Java, Javascript these days and got 11+ years of architecting and coding enterprise software solutions.   </p>"},footnote:{id:"/Users/prasanna/projects/blog/content/parts/footnote.md absPath of file >>> MarkdownRemark",html:"<ul>\n<li>rants and writings through personal experience</li>\n</ul>"},site:{siteMetadata:{facebook:{appId:"670156599751120%"}}}},pathContext:{slug:"/ace-with-react/"}}}});
//# sourceMappingURL=path---ace-with-react-04f84f978a4baec0c541.js.map