webpackJsonp([93535338360181],{886:function(e,t){e.exports={data:{post:{id:"/home/runner/work/blog/blog/content/posts/2014-05-01--re-running-testng-failed-tests/index.md absPath of file >>> MarkdownRemark",html:'<p>We were running our Selenium functional tests using <a href="http://testng.org/doc/index.html">testNG</a> runner in <a href="http://jenkins-ci.org/">Jenkins</a>. However the problem was we were having too many failures on our initial run, and lot of these failures were classified as random or not reproducable. Mainly these are test script issues. Some times the testers tend to put some static wait conditions which might work on their machine but not in the Jenkins agent. Sometimes the environment against which our tests run might be a bit slow which pushes our pass percentage well behind. The ideal appropriate fix will be is to go through the failed test cases and figure out the randomness and fix it. But we thought of adding a re run mechanism to our test job to identify these random failures. As the no. of test cases grew, we ended up in re running the failed tests multiple times, something like this.</p>\n<p>Name</p>\n<p>Total</p>\n<p>Failed</p>\n<p>Initial run</p>\n<p>100</p>\n<p>30</p>\n<p>ReRun1</p>\n<p>30</p>\n<p>20</p>\n<p>ReRun2</p>\n<p>20</p>\n<p>10</p>\n<p>In this case we will interpret the last 10 failures as a legitimate failures and rest as intermittent ones. </p>\n<p>Please note that this is not a correct approach to reduce the failure count. This make the testers more lazy since they always analyse only the failed tests in the final run. And this increases the running time of the job inadvertently since the sure fail cases runs for n times and failing always.</p>\n<h3>Re Running testNG failed tests using ANT</h3>\n<p>After every test run, testng will create a file called testng-failed.xml in the report directory which will contain the failed tests of that run. There was an issue with this file however. If you define multiple suites in your initial test suite file then this outer testng-failed.xml will contain the failed tests of the first run alone. The remaining suite’s failed tests will be in the inner directories under their corresponding suite names.</p>\n<p>This testng-failed.xml will also inherit all the properties from the original test suite file. For example if we have defined thread-count value then the same value will be retained.</p>\n<p>So what I did was copied this file to a location and fed this to the testng task to run again. This can be achieved by any means, since we were using ant as our build tool i configured this in our build.xml file itself.</p>\n<div class="gatsby-highlight" data-language="text">\n      <pre class="language-text"><code class="language-text">&lt;target name=&quot;runTests&quot; depends=&quot;compile&quot; description=&quot;Running tests&quot;&gt;\n\t&lt;echo&gt;Running Tests...&lt;/echo&gt;\n\t&lt;taskdef resource=&quot;testngtasks&quot; classpath=&quot;lib/testng-6.8.jar&quot; /&gt;\n\t&lt;testng outputDir=&quot;${report.dir}&quot; useDefaultListeners=&quot;true&quot; classpathref=&quot;build.classpath&quot; \n\t\tlisteners=&quot;org.uncommons.reportng.HTMLReporter,org.uncommons.reportng.JUnitXMLReporter&quot;&gt;\n\t\t&lt;classpath location=&quot;${class.dir}&quot; /&gt;\n\t\t&lt;xmlfileset dir=&quot;.&quot; includes=&quot;testng-suite.xml&quot; /&gt;\n\t\t&lt;sysproperty key=&quot;org.uncommons.reportng.title&quot; value=&quot; Test report&quot; /&gt;\n\t\t&lt;sysproperty key=&quot;properties&quot; value=&quot;${properties}&quot; /&gt;\n\t&lt;/testng&gt;\n\t&lt;copy file=&quot;${report.dir}/testng-failed.xml&quot; todir=&quot;${basedir}/test-output-rerun/0&quot;/&gt;\n\t\n\t&lt;antcall target=&quot;multiReRun&quot;/&gt;\n&lt;/target&gt;\n&lt;target name=&quot;multiReRun&quot; description=&quot;Multiple rerun tests&quot;&gt;\n\t&lt;antcall target=&quot;runFailedTests&quot;&gt;\n\t\t&lt;param name=&quot;rerun.report.dir&quot; value=&quot;${rerun.base.dir}/1&quot;/&gt;\n\t\t&lt;param name=&quot;src.rerun.dir&quot; value=&quot;${rerun.base.dir}/0&quot;/&gt;\n\t&lt;/antcall&gt;\n\t&lt;antcall target=&quot;runFailedTests&quot;&gt;\n\t\t&lt;param name=&quot;rerun.report.dir&quot; value=&quot;${rerun.base.dir}/2&quot;/&gt;\n\t\t&lt;param name=&quot;src.rerun.dir&quot; value=&quot;${rerun.base.dir}/1&quot;/&gt;\n\t&lt;/antcall&gt;\n&lt;/target&gt;</code></pre>\n      </div>\n<p>Here output folder of the init run will be test-output. And am copying testng-failed.xml from test-output to test-output-rerun/0 . This is just to make my multiReRun more convenient. Now i have repeated the block of code for two times. This is due to the fact that ant doesn’t support the regular for..counter loop.</p>\n<p>When i went through some ant docs figured out that ant script supports JavaScript!! May be i can use that to constuct a string like “1,2,3,4,5” and pass it onto the for loop of ant.</p>',htmlAst:{type:"root",children:[{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"We were running our Selenium functional tests using "},{type:"element",tagName:"a",properties:{href:"http://testng.org/doc/index.html"},children:[{type:"text",value:"testNG"}]},{type:"text",value:" runner in "},{type:"element",tagName:"a",properties:{href:"http://jenkins-ci.org/"},children:[{type:"text",value:"Jenkins"}]},{type:"text",value:". However the problem was we were having too many failures on our initial run, and lot of these failures were classified as random or not reproducable. Mainly these are test script issues. Some times the testers tend to put some static wait conditions which might work on their machine but not in the Jenkins agent. Sometimes the environment against which our tests run might be a bit slow which pushes our pass percentage well behind. The ideal appropriate fix will be is to go through the failed test cases and figure out the randomness and fix it. But we thought of adding a re run mechanism to our test job to identify these random failures. As the no. of test cases grew, we ended up in re running the failed tests multiple times, something like this."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Name"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Total"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Failed"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Initial run"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"100"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"30"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"ReRun1"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"30"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"20"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"ReRun2"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"20"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"10"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"In this case we will interpret the last 10 failures as a legitimate failures and rest as intermittent ones. "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Please note that this is not a correct approach to reduce the failure count. This make the testers more lazy since they always analyse only the failed tests in the final run. And this increases the running time of the job inadvertently since the sure fail cases runs for n times and failing always."}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"Re Running testNG failed tests using ANT"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"After every test run, testng will create a file called testng-failed.xml in the report directory which will contain the failed tests of that run. There was an issue with this file however. If you define multiple suites in your initial test suite file then this outer testng-failed.xml will contain the failed tests of the first run alone. The remaining suite’s failed tests will be in the inner directories under their corresponding suite names."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"This testng-failed.xml will also inherit all the properties from the original test suite file. For example if we have defined thread-count value then the same value will be retained."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"So what I did was copied this file to a location and fed this to the testng task to run again. This can be achieved by any means, since we were using ant as our build tool i configured this in our build.xml file itself."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"text"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-text"]},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:'<target name="runTests" depends="compile" description="Running tests">\n\t<echo>Running Tests...</echo>\n\t<taskdef resource="testngtasks" classpath="lib/testng-6.8.jar" />\n\t<testng outputDir="${report.dir}" useDefaultListeners="true" classpathref="build.classpath" \n\t\tlisteners="org.uncommons.reportng.HTMLReporter,org.uncommons.reportng.JUnitXMLReporter">\n\t\t<classpath location="${class.dir}" />\n\t\t<xmlfileset dir="." includes="testng-suite.xml" />\n\t\t<sysproperty key="org.uncommons.reportng.title" value=" Test report" />\n\t\t<sysproperty key="properties" value="${properties}" />\n\t</testng>\n\t<copy file="${report.dir}/testng-failed.xml" todir="${basedir}/test-output-rerun/0"/>\n\t\n\t<antcall target="multiReRun"/>\n</target>\n<target name="multiReRun" description="Multiple rerun tests">\n\t<antcall target="runFailedTests">\n\t\t<param name="rerun.report.dir" value="${rerun.base.dir}/1"/>\n\t\t<param name="src.rerun.dir" value="${rerun.base.dir}/0"/>\n\t</antcall>\n\t<antcall target="runFailedTests">\n\t\t<param name="rerun.report.dir" value="${rerun.base.dir}/2"/>\n\t\t<param name="src.rerun.dir" value="${rerun.base.dir}/1"/>\n\t</antcall>\n</target>'}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Here output folder of the init run will be test-output. And am copying testng-failed.xml from test-output to test-output-rerun/0 . This is just to make my multiReRun more convenient. Now i have repeated the block of code for two times. This is due to the fact that ant doesn’t support the regular for..counter loop."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"When i went through some ant docs figured out that ant script supports JavaScript!! May be i can use that to constuct a string like “1,2,3,4,5” and pass it onto the for loop of ant."}]}],data:{quirksMode:!1}},fields:{slug:"/re-running-testng-failed-tests/",prefix:"2014-05-01"},frontmatter:{title:"Re running testNG failed times n times.",subTitle:"Steps to set up re-runn of testNG failed tests for n number of times, using ant task.",cover:null,draft:null}},author:{id:"/home/runner/work/blog/blog/content/parts/author.md absPath of file >>> MarkdownRemark",html:"<p><strong>Prasanna</strong> is a full stack web developer, with loads of experience in architecting and coding enterprise software solutions.  </p>"},footnote:{id:"/home/runner/work/blog/blog/content/parts/footnote.md absPath of file >>> MarkdownRemark",html:"<ul>\n<li>rants and writings through personal experience</li>\n</ul>"},site:{siteMetadata:{facebook:{appId:"670156599751120%"}}}},pathContext:{slug:"/re-running-testng-failed-tests/"}}}});
//# sourceMappingURL=path---re-running-testng-failed-tests-4c9c180c339eee276d88.js.map